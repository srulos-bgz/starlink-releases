<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Alert SDK Test - Starlink SDK</title>
    <link rel="stylesheet" href="css/starlink-sdk-test.css">
</head>
<body data-theme="alert">
    <div class="container">
        <a href="index.html" class="back-link">‚Üê Back to SDK Test Suite</a>
        
        <div class="header">
            <h1>‚ö†Ô∏è Alert SDK Test</h1>
            <p>Native iOS alert dialogs with customizable buttons and messages</p>
        </div>
        
        <div class="test-panel">
            <!-- SDK Status Section -->
            <div class="status-section">
                <h3>
                    <span class="status-indicator status-warning" id="statusIndicator"></span>
                    SDK Status
                </h3>
                <div class="status-details" id="statusDetails">
                    Checking Alert SDK availability...
                </div>
            </div>

            <!-- Available Methods Section -->
            <div id="methods-container"></div>

            <!-- Interactive Test Section -->
            <div class="test-section">
                <h3>üöÄ Test Alert Methods</h3>
                
                <!-- Basic Alert Test -->
                <div class="form-group">
                    <label>Basic Alert</label>
                    <div class="button-group">
                        <button class="btn btn-primary" onclick="testBasicAlert()">
                            üì¢ Show Alert
                        </button>
                        <button class="btn-code code-toggle" id="alertCodeBtn">
                            Show Code
                        </button>
                    </div>
                    <div id="alertCode" style="display: none;"></div>
                </div>

                <!-- Custom Alert Test -->
                <div class="form-group">
                    <label for="alertMessage">Custom Alert</label>
                    <input type="text" id="alertMessage" placeholder="Enter alert message" value="Operation completed successfully!">
                    <input type="text" id="alertTitle" placeholder="Enter alert title" value="Success">
                    <input type="text" id="alertButton" placeholder="Enter button text" value="Got it">
                    <div class="button-group">
                        <button class="btn btn-primary" onclick="testCustomAlert()">
                            üì¢ Show Custom Alert
                        </button>
                        <button class="btn-code code-toggle" id="customAlertCodeBtn">
                            Show Code
                        </button>
                    </div>
                    <div id="customAlertCode" style="display: none;"></div>
                </div>

                <!-- Confirm Test -->
                <div class="form-group">
                    <label for="confirmMessage">Confirm Dialog</label>
                    <input type="text" id="confirmMessage" placeholder="Enter confirm message" value="Are you sure you want to delete this item?">
                    <input type="text" id="confirmTitle" placeholder="Enter confirm title" value="Confirmation">
                    <input type="text" id="confirmOK" placeholder="Confirm button text" value="Delete">
                    <input type="text" id="confirmCancel" placeholder="Cancel button text" value="Cancel">
                    <div class="button-group">
                        <button class="btn btn-primary" onclick="testConfirm()">
                            ‚ùì Show Confirm
                        </button>
                        <button class="btn-code code-toggle" id="confirmCodeBtn">
                            Show Code
                        </button>
                    </div>
                    <div id="confirmCode" style="display: none;"></div>
                </div>

                <!-- Prompt Test -->
                <div class="form-group">
                    <label for="promptMessage">Prompt Dialog</label>
                    <input type="text" id="promptMessage" placeholder="Enter prompt message" value="Enter your name:">
                    <input type="text" id="promptTitle" placeholder="Enter prompt title" value="User Input">
                    <input type="text" id="promptPlaceholder" placeholder="Input placeholder" value="Name here...">
                    <input type="text" id="promptDefault" placeholder="Default value" value="">
                    <div class="button-group">
                        <button class="btn btn-primary" onclick="testPrompt()">
                            ‚úèÔ∏è Show Prompt
                        </button>
                        <button class="btn-code code-toggle" id="promptCodeBtn">
                            Show Code
                        </button>
                    </div>
                    <div id="promptCode" style="display: none;"></div>
                </div>

                <!-- Action Sheet Test -->
                <div class="form-group">
                    <label for="actionTitle">Action Sheet</label>
                    <input type="text" id="actionTitle" placeholder="Action sheet title" value="Choose an action">
                    <input type="text" id="actionMessage" placeholder="Action sheet message" value="What would you like to do?">
                    <input type="text" id="actionButtons" placeholder="Action buttons (comma separated)" value="Edit,Share,Delete">
                    <div class="button-group">
                        <button class="btn btn-primary" onclick="testActionSheet()">
                            üìã Show Action Sheet
                        </button>
                        <button class="btn-code code-toggle" id="actionCodeBtn">
                            Show Code
                        </button>
                    </div>
                    <div id="actionCode" style="display: none;"></div>
                </div>

                <div id="result-area" class="result-area">
                    Results will appear here...
                </div>
            </div>
        </div>
    </div>

    <script src="js/starlink-sdk-test.js"></script>
    <script>
        // SDK-specific configuration
        const SDK_CONFIG = {
            moduleName: 'Alert',
            methods: [
                {
                    signature: 'alert(message, title, buttonText)',
                    description: 'Show native iOS alert dialog',
                    autoCall: false
                },
                {
                    signature: 'confirm(message, title, confirmText, cancelText)',
                    description: 'Show native iOS confirm dialog',
                    autoCall: false
                },
                {
                    signature: 'prompt(message, title, placeholder, defaultValue, confirmText, cancelText)',
                    description: 'Show native iOS prompt dialog for text input',
                    autoCall: false
                },
                {
                    signature: 'actionSheet(title, message, actions, cancelText)',
                    description: 'Show native iOS action sheet (iPad compatible)',
                    autoCall: false
                }
            ],
            autoRun: false,
            interactive: true
        };

        // Initialize components
        const sdkStatus = new StarlinkSDK.StarlinkSDKStatus(SDK_CONFIG.moduleName);
        const methodsDisplay = new StarlinkSDK.MethodsDisplay();
        const resultDisplay = new StarlinkSDK.ResultDisplay();
        const codeDisplay = new StarlinkSDK.CodeDisplay();

        // Page initialization
        document.addEventListener('DOMContentLoaded', function() {
            // Check SDK status
            const isAvailable = sdkStatus.check();
            
            // Setup methods display
            setupMethods();
            
            // Setup interactive elements
            if (isAvailable) {
                setupInteractive();
            }
        });

        function setupMethods() {
            SDK_CONFIG.methods.forEach(method => {
                methodsDisplay.addMethod(
                    method.signature,
                    method.description,
                    method.autoCall || false
                );
            });
            methodsDisplay.render();
        }

        function setupInteractive() {
            // Setup code displays
            codeDisplay.register('alertCodeBtn', 'alertCode', 
                StarlinkSDK.StarlinkUtils.createCodeBlock(
                    'const result = await window.Starlink.Alert.alert("Hello World!");'
                )
            );
            
            codeDisplay.register('customAlertCodeBtn', 'customAlertCode', 
                StarlinkSDK.StarlinkUtils.createCodeBlock(
                    'const result = await window.Starlink.Alert.alert(message, title, buttonText);'
                )
            );
            
            codeDisplay.register('confirmCodeBtn', 'confirmCode', 
                StarlinkSDK.StarlinkUtils.createCodeBlock(
                    'const result = await window.Starlink.Alert.confirm(message, title, confirmText, cancelText);'
                )
            );
            
            codeDisplay.register('promptCodeBtn', 'promptCode', 
                StarlinkSDK.StarlinkUtils.createCodeBlock(
                    'const result = await window.Starlink.Alert.prompt(message, title, placeholder, defaultValue, confirmText, cancelText);'
                )
            );
            
            codeDisplay.register('actionCodeBtn', 'actionCode', 
                StarlinkSDK.StarlinkUtils.createCodeBlock(
                    'const result = await window.Starlink.Alert.actionSheet(title, message, actions, cancelText);'
                )
            );
        }

        async function testBasicAlert() {
            if (!window.Starlink || !window.Starlink.Alert) {
                resultDisplay.showError('‚ùå Error: Starlink Alert bridge not available. This test requires Starlink WebView environment.');
                return;
            }

            try {
                resultDisplay.showInfo('üîÑ Showing basic alert...');
                codeDisplay.show('alertCodeBtn');
                
                // ===== NATIVE API CALL =====
                const result = await window.Starlink.Alert.alert("Hello World!");
                // ===========================
                
                const successMessage = resultDisplay.formatApiResult(
                    'Alert.alert',
                    { message: "Hello World!" },
                    result,
                    true
                );
                
                resultDisplay.showSuccess(successMessage);
                
            } catch (error) {
                const errorMessage = resultDisplay.formatApiResult(
                    'Alert.alert',
                    { message: "Hello World!" },
                    error.message,
                    false
                );
                
                resultDisplay.showError(errorMessage);
            }
        }

        async function testCustomAlert() {
            const message = document.getElementById('alertMessage').value.trim();
            const title = document.getElementById('alertTitle').value.trim();
            const buttonText = document.getElementById('alertButton').value.trim();
            
            if (!message) {
                resultDisplay.showError('‚ùå Error: Alert message is required');
                return;
            }

            if (!window.Starlink || !window.Starlink.Alert) {
                resultDisplay.showError('‚ùå Error: Starlink Alert bridge not available. This test requires Starlink WebView environment.');
                return;
            }

            try {
                resultDisplay.showInfo('üîÑ Showing custom alert...');
                codeDisplay.show('customAlertCodeBtn');
                
                // ===== NATIVE API CALL =====
                const result = await window.Starlink.Alert.alert(message, title, buttonText);
                // ===========================
                
                const successMessage = resultDisplay.formatApiResult(
                    'Alert.alert',
                    { message, title, buttonText },
                    result,
                    true
                );
                
                resultDisplay.showSuccess(successMessage);
                
            } catch (error) {
                const errorMessage = resultDisplay.formatApiResult(
                    'Alert.alert',
                    { message, title, buttonText },
                    error.message,
                    false
                );
                
                resultDisplay.showError(errorMessage);
            }
        }

        async function testConfirm() {
            const message = document.getElementById('confirmMessage').value.trim();
            const title = document.getElementById('confirmTitle').value.trim();
            const confirmText = document.getElementById('confirmOK').value.trim();
            const cancelText = document.getElementById('confirmCancel').value.trim();
            
            if (!message) {
                resultDisplay.showError('‚ùå Error: Confirm message is required');
                return;
            }

            if (!window.Starlink || !window.Starlink.Alert) {
                resultDisplay.showError('‚ùå Error: Starlink Alert bridge not available. This test requires Starlink WebView environment.');
                return;
            }

            try {
                resultDisplay.showInfo('üîÑ Showing confirm dialog...');
                codeDisplay.show('confirmCodeBtn');
                
                // ===== NATIVE API CALL =====
                const result = await window.Starlink.Alert.confirm(message, title, confirmText, cancelText);
                // ===========================
                
                const successMessage = resultDisplay.formatApiResult(
                    'Alert.confirm',
                    { message, title, confirmText, cancelText },
                    `User ${result ? 'confirmed' : 'cancelled'} (${result})`,
                    true
                );
                
                resultDisplay.showSuccess(successMessage);
                
            } catch (error) {
                const errorMessage = resultDisplay.formatApiResult(
                    'Alert.confirm',
                    { message, title, confirmText, cancelText },
                    error.message,
                    false
                );
                
                resultDisplay.showError(errorMessage);
            }
        }

        async function testPrompt() {
            const message = document.getElementById('promptMessage').value.trim();
            const title = document.getElementById('promptTitle').value.trim();
            const placeholder = document.getElementById('promptPlaceholder').value.trim();
            const defaultValue = document.getElementById('promptDefault').value.trim();
            
            if (!message) {
                resultDisplay.showError('‚ùå Error: Prompt message is required');
                return;
            }

            if (!window.Starlink || !window.Starlink.Alert) {
                resultDisplay.showError('‚ùå Error: Starlink Alert bridge not available. This test requires Starlink WebView environment.');
                return;
            }

            try {
                resultDisplay.showInfo('üîÑ Showing prompt dialog...');
                codeDisplay.show('promptCodeBtn');
                
                // ===== NATIVE API CALL =====
                const result = await window.Starlink.Alert.prompt(message, title, placeholder, defaultValue);
                // ===========================
                
                const successMessage = resultDisplay.formatApiResult(
                    'Alert.prompt',
                    { message, title, placeholder, defaultValue },
                    result !== null ? `"${result}"` : 'null (cancelled)',
                    true
                );
                
                resultDisplay.showSuccess(successMessage);
                
            } catch (error) {
                const errorMessage = resultDisplay.formatApiResult(
                    'Alert.prompt',
                    { message, title, placeholder, defaultValue },
                    error.message,
                    false
                );
                
                resultDisplay.showError(errorMessage);
            }
        }

        async function testActionSheet() {
            const title = document.getElementById('actionTitle').value.trim();
            const message = document.getElementById('actionMessage').value.trim();
            const buttonsText = document.getElementById('actionButtons').value.trim();
            
            if (!buttonsText) {
                resultDisplay.showError('‚ùå Error: Action buttons are required');
                return;
            }

            const actions = buttonsText.split(',').map(btn => btn.trim()).filter(btn => btn);
            if (actions.length === 0) {
                resultDisplay.showError('‚ùå Error: At least one action button is required');
                return;
            }

            if (!window.Starlink || !window.Starlink.Alert) {
                resultDisplay.showError('‚ùå Error: Starlink Alert bridge not available. This test requires Starlink WebView environment.');
                return;
            }

            try {
                resultDisplay.showInfo('üîÑ Showing action sheet...');
                codeDisplay.show('actionCodeBtn');
                
                // ===== NATIVE API CALL =====
                const result = await window.Starlink.Alert.actionSheet(title, message, actions, 'Cancel');
                // ===========================
                
                let resultText;
                if (result === -1) {
                    resultText = 'User cancelled (-1)';
                } else {
                    resultText = `User selected "${actions[result]}" (index: ${result})`;
                }
                
                const successMessage = resultDisplay.formatApiResult(
                    'Alert.actionSheet',
                    { title, message, actions, cancelText: 'Cancel' },
                    resultText,
                    true
                );
                
                resultDisplay.showSuccess(successMessage);
                
            } catch (error) {
                const errorMessage = resultDisplay.formatApiResult(
                    'Alert.actionSheet',
                    { title, message, actions, cancelText: 'Cancel' },
                    error.message,
                    false
                );
                
                resultDisplay.showError(errorMessage);
            }
        }
    </script>
</body>
</html>
